<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Angr_CTF - Frost's blog</title><meta name=Description content><meta property="og:title" content="Angr_CTF"><meta property="og:description" content="ÄÃ¢y lÃ  post ghi láº¡i lá»i giáº£i cá»§a nhá»¯ng bÃ i mÃ¬nh giáº£i Ä‘Æ°á»£c trong Angr_CTF: https://github.com/jakespringer/angr_ctf. Ok, báº¯t Ä‘áº§u luÃ´n nÃ o.
Note: BÃ i nÃ y á»Ÿ wordpress thÃ¬ mÃ¬nh ghi khÃ¡ chi tiáº¿t, tuy nhiÃªn khi dá»i qua Ä‘Ã¢y thÃ¬ bá»‡nh lÆ°á»i láº¡i tÃ¡i phÃ¡t. Do Ä‘Ã³ mÃ¬nh sáº½ khÃ´ng ghi láº¡i Ä‘áº§y Ä‘á»§ mÃ  chá»‰ viáº¿t nhá»¯ng Ä‘iá»ƒm chÃ­nh thÃ´i (thÃªm ná»¯a lÃ  khÃ´ng cÃ³ hÃ¬nh chá»¥p IDA luÃ´n nha). Äá»ƒ Ä‘á»c bÃ i viáº¿t chi tiáº¿t thÃ¬ báº¡n cÃ³ thá»ƒ vÃ o Ä‘Ã¢y"><meta property="og:type" content="article"><meta property="og:url" content="/posts/old_posts/2020-07-07-angr-ctf/"><meta property="og:image" content="/images/slime-attack.gif"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-07-07T00:00:00+00:00"><meta property="article:modified_time" content="2020-07-07T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/images/slime-attack.gif"><meta name=twitter:title content="Angr_CTF"><meta name=twitter:description content="ÄÃ¢y lÃ  post ghi láº¡i lá»i giáº£i cá»§a nhá»¯ng bÃ i mÃ¬nh giáº£i Ä‘Æ°á»£c trong Angr_CTF: https://github.com/jakespringer/angr_ctf. Ok, báº¯t Ä‘áº§u luÃ´n nÃ o.
Note: BÃ i nÃ y á»Ÿ wordpress thÃ¬ mÃ¬nh ghi khÃ¡ chi tiáº¿t, tuy nhiÃªn khi dá»i qua Ä‘Ã¢y thÃ¬ bá»‡nh lÆ°á»i láº¡i tÃ¡i phÃ¡t. Do Ä‘Ã³ mÃ¬nh sáº½ khÃ´ng ghi láº¡i Ä‘áº§y Ä‘á»§ mÃ  chá»‰ viáº¿t nhá»¯ng Ä‘iá»ƒm chÃ­nh thÃ´i (thÃªm ná»¯a lÃ  khÃ´ng cÃ³ hÃ¬nh chá»¥p IDA luÃ´n nha). Äá»ƒ Ä‘á»c bÃ i viáº¿t chi tiáº¿t thÃ¬ báº¡n cÃ³ thá»ƒ vÃ o Ä‘Ã¢y"><meta name=application-name content="LoveIt"><meta name=apple-mobile-web-app-title content="LoveIt"><link rel="shortcut icon" type=image/x-icon href=../../../favicon.ico><link rel=icon type=image/png sizes=32x32 href=../../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../../favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=../../../apple-touch-icon.png><link rel=manifest href=../../../site.webmanifest><link rel=canonical href=../../../posts/old_posts/2020-07-07-angr-ctf/><link rel=prev href=../../../posts/old_posts/2020-7-7-aslr/><link rel=next href=../../../posts/old_posts/2020-07-07-angr-basic/><link rel=stylesheet href=../../../lib/normalize/normalize.min.css><link rel=stylesheet href=../../../css/style.min.css><link rel=stylesheet href=../../../lib/fontawesome-free/all.min.css><link rel=stylesheet href=../../../lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Angr_CTF","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"\/posts\/old_posts\/2020-07-07-angr-ctf\/"},"genre":"posts","keywords":"learning, writeup","wordcount":1727,"url":"\/posts\/old_posts\/2020-07-07-angr-ctf\/","datePublished":"2020-07-07T00:00:00+00:00","dateModified":"2020-07-07T00:00:00+00:00","publisher":{"@type":"Organization","name":"Frost"},"author":{"@type":"Person","name":"Frost"},"description":""}</script></head><body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=../../../ title="Frost's blog"><img class="lazyload logo" src=../../../svg/loading.min.svg data-src=../../../images/slime-attack.gif data-srcset="../../../images/slime-attack.gif, ../../../images/slime-attack.gif 1.5x, ../../../images/slime-attack.gif 2x" data-sizes=auto alt=/images/slime-attack.gif title=/images/slime-attack.gif></a></div><div class=menu><div class=menu-inner><a class=menu-item href=../../../posts/>Posts </a><a class=menu-item href=../../../tags/>Tags </a><a class=menu-item href=../../../about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=../../../ title="Frost's blog"><img class="lazyload logo" src=../../../svg/loading.min.svg data-src=../../../images/slime-attack.gif data-srcset="../../../images/slime-attack.gif, ../../../images/slime-attack.gif 1.5x, ../../../images/slime-attack.gif 2x" data-sizes=auto alt=/images/slime-attack.gif title=/images/slime-attack.gif></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=../../../posts/ title>Posts</a><a class=menu-item href=../../../tags/ title>Tags</a><a class=menu-item href=../../../about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Angr_CTF</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=../../../ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Frost</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-07-07>2020-07-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1727 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;9 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#01_angr_avoid>01_angr_avoid</a></li><li><a href=#02_angr_find_condition>02_angr_find_condition</a></li><li><a href=#03_angr_symbolic_registers>03_angr_symbolic_registers</a></li><li><a href=#04_angr_symbolic_stack>04_angr_symbolic_stack</a></li><li><a href=#05_angr_symbolic_memory>05_angr_symbolic_memory</a></li><li><a href=#06_angr_symbolic_dynamic_memory>06_angr_symbolic_dynamic_memory</a></li><li><a href=#08_angr_constraints>08_angr_constraints</a></li><li><a href=#09_angr_hooks>09_angr_hooks</a></li><li><a href=#12_angr_veritesting>12_angr_veritesting</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>ÄÃ¢y lÃ  post ghi láº¡i lá»i giáº£i cá»§a nhá»¯ng bÃ i mÃ¬nh giáº£i Ä‘Æ°á»£c trong Angr_CTF: <a href=https://github.com/jakespringer/angr_ctf target=_blank rel="noopener noreffer">https://github.com/jakespringer/angr_ctf</a>. Ok, báº¯t Ä‘áº§u luÃ´n nÃ o.</p><p><em>Note:</em> BÃ i nÃ y á»Ÿ wordpress thÃ¬ mÃ¬nh ghi khÃ¡ chi tiáº¿t, tuy nhiÃªn khi dá»i qua Ä‘Ã¢y thÃ¬ bá»‡nh lÆ°á»i láº¡i tÃ¡i phÃ¡t. Do Ä‘Ã³ mÃ¬nh sáº½ khÃ´ng ghi láº¡i Ä‘áº§y Ä‘á»§ mÃ  chá»‰ viáº¿t nhá»¯ng
Ä‘iá»ƒm chÃ­nh thÃ´i (thÃªm ná»¯a lÃ  khÃ´ng cÃ³ hÃ¬nh chá»¥p IDA luÃ´n nha). Äá»ƒ Ä‘á»c bÃ i viáº¿t chi tiáº¿t thÃ¬ báº¡n cÃ³ thá»ƒ vÃ o <a href=https://blackfrost984.wordpress.com/2020/03/30/angr_ctf/ target=_blank rel="noopener noreffer">Ä‘Ã¢y</a></p><h3 id=01_angr_avoid>01_angr_avoid</h3><p>BÃ i nÃ y mÃ¬nh sáº½ dÃ¹ng .explore cá»§a Angr Ä‘á»ƒ giáº£i.
Khi dÃ¹ng .explore() vá»›i tham sá»‘ find, Angr sáº½ tá»± Ä‘á»™ng execute binary Ä‘áº¿n khi Ä‘áº¡t Ä‘Æ°á»£c má»™t state thá»a mÃ£n Ä‘iá»u kiá»‡n cá»§a find. GiÃ¡ trá»‹ cá»§a find cÃ³ thá»ƒ lÃ :
â€“ Má»™t Ä‘á»‹a chá»‰ hoáº·c má»™t list cÃ¡c Ä‘á»‹a chá»‰.
â€“ Má»™t hÃ m. HÃ m nÃ y nháº­n tham sá»‘ lÃ  má»™t state vÃ  tráº£ vá» Ä‘iá»u kiá»‡n mÃ  state Ä‘Ã³ cáº§n thá»a mÃ£n (cÃ¡i nÃ y sáº½ Ä‘Æ°á»£c minh há»a á»Ÿ bÃ i tiáº¿p theo)
CÃ¡c state thá»a mÃ£n sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o 1 stash tÃªn lÃ  found (cÃ³ thá»ƒ hiá»ƒu stash lÃ  1 list cÃ¡c state). Theo máº·c Ä‘á»‹nh, khi tÃ¬m Ä‘Æ°á»£c 1 state thá»a mÃ£n, Angr sáº½ dá»«ng viá»‡c tÃ¬m kiáº¿m, tuy nhiÃªn ta cÃ³ thá»ƒ thay Ä‘á»•i Ä‘iá»u nÃ y báº±ng cÃ¡ch truyá»n thÃªm tham sá»‘ num_found cho .explore().</p><p>TÆ°Æ¡ng tá»± vá»›i find ta cÅ©ng cÃ³ tham sá»‘ avoid Ä‘á»ƒ chá»‰ ra nhá»¯ng chá»— mÃ  Angr cáº§n â€œtrÃ¡nhâ€. CÃ¡c giÃ¡ trá»‹ mÃ  avoid cÃ³ thá»ƒ nháº­n cÅ©ng tÆ°Æ¡ng tá»± nhÆ° find. Khi gáº·p pháº£i Ä‘iá»u kiá»‡n khá»›p vá»›i tham sá»‘ avoid, Angr sáº½ bá» state Ä‘ang thá»±c thi vÃ o stash avoided, Ä‘á»“ng thá»i dá»«ng thá»±c thi state Ä‘Ã³.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>angr</span>
</span></span><span class=line><span class=cl><span class=n>proj</span><span class=o>=</span><span class=n>angr</span><span class=o>.</span><span class=n>Project</span><span class=p>(</span><span class=s2>&#34;./01_angr_avoid&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>=</span><span class=mh>0x08048602</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>entry_state</span><span class=p>(</span><span class=n>addr</span><span class=o>=</span><span class=n>main</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>simulation_manager</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>â€œGood jobâ€ chá»‰ Ä‘Æ°á»£c in á»Ÿ hÃ m â€œmaybe_goodâ€, nÃªn find sáº½ mang Ä‘á»‹a chá»‰ cá»§a hÃ m nÃ y. BÃªn cáº¡nh Ä‘Ã³ ta cÅ©ng cÃ³ hÃ m â€œavoid_meâ€, hÃ m nÃ y Ä‘Æ°a biáº¿n â€œshould_successâ€ vá» 0 (biáº¿n nÃ y vá» 0 thÃ¬ luÃ´n â€œtry againâ€) nÃªn ta sáº½ trÃ¡nh Ä‘á»‹a chá»‰ hÃ m nÃ y.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>angr</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>proj</span><span class=o>=</span><span class=n>angr</span><span class=o>.</span><span class=n>Project</span><span class=p>(</span><span class=s2>&#34;./01_angr_avoid&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>main</span><span class=o>=</span><span class=mh>0x08048602</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>entry_state</span><span class=p>(</span><span class=n>addr</span><span class=o>=</span><span class=n>main</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>simulation_manager</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>good</span><span class=o>=</span><span class=mh>0x080485E0</span>
</span></span><span class=line><span class=cl><span class=n>bad</span><span class=o>=</span><span class=mh>0x080485A8</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>.</span><span class=n>explore</span><span class=p>(</span><span class=n>find</span><span class=o>=</span><span class=n>good</span><span class=p>,</span><span class=n>advoid</span><span class=o>=</span><span class=n>bad</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=ow>not</span> <span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Something is wrong!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>found</span><span class=o>=</span><span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=o>=</span><span class=n>found</span><span class=o>.</span><span class=n>posix</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Note:</strong> simgr.found lÃ  má»™t list gá»“m nhiá»u state, láº¥y má»™t state trong Ä‘Ã³ giá»‘ng nhÆ° má»™t list bÃ¬nh thÆ°á»ng (simgr.found[0])</p><h3 id=02_angr_find_condition>02_angr_find_condition</h3><p>Má»›i Ä‘áº§u thÃ¬ mÃ¬nh tÆ°á»Ÿng nÃ³ cÅ©ng giá»‘ng chall trÆ°á»›c, cÆ¡ mÃ  nhÃ¬n vÃ o má»›i tháº¥y ráº¯ng cÃ³ má»™t Ä‘á»‘ng Ä‘á»‹a chá»‰ in chá»¯ â€œGood job.â€ ğŸ™‚ , do Ä‘Ã³ khÃ´ng truyá»n Ä‘á»‹a chá»‰ vÃ´ biáº¿n find Ä‘Æ°á»£c rá»“i.</p><p>Váº­y pháº£i truyá»n hÃ m vÃ o thÃ´i, hÃ m nÃ y sáº½ kiá»ƒm tra xem â€œGood job.â€ cÃ³ in ra mÃ n hÃ¬nh khÃ´ng. Ta Ä‘Æ°a thÃªm hÃ m kiá»ƒm tra â€œTry againâ€ vÃ o avoid luÃ´n.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>angr</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>proj</span><span class=o>=</span><span class=n>angr</span><span class=o>.</span><span class=n>Project</span><span class=p>(</span><span class=s2>&#34;./02_angr_find_condition&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>entry_state</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>simulation_manager</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>good</span><span class=p>(</span><span class=n>state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;Good Job.&#34;</span> <span class=ow>in</span> <span class=p>(</span><span class=n>state</span><span class=o>.</span><span class=n>posix</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>bad</span><span class=p>(</span><span class=n>state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;Try again.&#34;</span> <span class=ow>in</span> <span class=p>(</span><span class=n>state</span><span class=o>.</span><span class=n>posix</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>.</span><span class=n>explore</span><span class=p>(</span><span class=n>find</span><span class=o>=</span><span class=n>good</span><span class=p>,</span><span class=n>avoid</span><span class=o>=</span><span class=n>bad</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>angr</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>proj</span><span class=o>=</span><span class=n>angr</span><span class=o>.</span><span class=n>Project</span><span class=p>(</span><span class=s2>&#34;./02_angr_find_condition&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>entry_state</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>simulation_manager</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>good</span><span class=p>(</span><span class=n>state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;Good Job.&#34;</span> <span class=ow>in</span> <span class=p>(</span><span class=n>state</span><span class=o>.</span><span class=n>posix</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>bad</span><span class=p>(</span><span class=n>state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;Try again.&#34;</span> <span class=ow>in</span> <span class=p>(</span><span class=n>state</span><span class=o>.</span><span class=n>posix</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>.</span><span class=n>explore</span><span class=p>(</span><span class=n>find</span><span class=o>=</span><span class=n>good</span><span class=p>,</span><span class=n>avoid</span><span class=o>=</span><span class=n>bad</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span><span class=o>=</span><span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=o>=</span><span class=n>result</span><span class=o>.</span><span class=n>posix</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=p>(</span><span class=s2>&#34;Something is wrong&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=03_angr_symbolic_registers>03_angr_symbolic_registers</h3><p>á» chall nÃ y, Angr khÃ´ng tá»± Ä‘á»™ng inject symbol cho mÃ¬nh ná»¯a. LÃ½ do lÃ  bá»Ÿi Angr chá»‰ cÃ³ thá»ƒ xá»­ lÃ½ cÃ¡c format string Ä‘Æ¡n giáº£n trong lá»‡nh scanf. Vá»›i 3 chall trÆ°á»›c, format string Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ láº¥y input lÃ  %8s , tuy nhiÃªn chall nÃ y thÃ¬ format string lÃ  â€œ%x %x %xâ€, Angr khÃ´ng chÃ¨n symbol giÃ¹m Ä‘Æ°á»£c.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>angr</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#create a state</span>
</span></span><span class=line><span class=cl><span class=n>proj</span><span class=o>=</span><span class=n>angr</span><span class=o>.</span><span class=n>Project</span><span class=p>(</span><span class=s2>&#34;./03_angr_symbolic_registers&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>start_addr</span><span class=o>=</span><span class=mh>0x08048980</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>blank_state</span><span class=p>(</span><span class=n>addr</span><span class=o>=</span><span class=n>start_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#create some symbols</span>
</span></span><span class=line><span class=cl><span class=n>a</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVS</span><span class=p>(</span><span class=s2>&#34;a&#34;</span><span class=p>,</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>b</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVS</span><span class=p>(</span><span class=s2>&#34;b&#34;</span><span class=p>,</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVS</span><span class=p>(</span><span class=s2>&#34;d&#34;</span><span class=p>,</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#write those symbols to registers</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>eax</span><span class=o>=</span><span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>ebx</span><span class=o>=</span><span class=n>b</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>edx</span><span class=o>=</span><span class=n>d</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#symbolic execution!!!</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>simulation_manager</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>good</span><span class=o>=</span><span class=mh>0x080489EE</span>
</span></span><span class=line><span class=cl><span class=n>bad</span><span class=o>=</span><span class=mh>0x080489DC</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>.</span><span class=n>explore</span><span class=p>(</span><span class=n>find</span><span class=o>=</span><span class=n>good</span><span class=p>,</span><span class=n>avoid</span><span class=o>=</span><span class=n>bad</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=ow>not</span> <span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>raise</span> <span class=n>Execption</span><span class=p>(</span><span class=s2>&#34;Something is wrong!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#print the result</span>
</span></span><span class=line><span class=cl><span class=n>result</span><span class=o>=</span><span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>pass0</span><span class=o>=</span><span class=nb>hex</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>pass1</span><span class=o>=</span><span class=nb>hex</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>pass2</span><span class=o>=</span><span class=nb>hex</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>d</span><span class=p>))</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=p>(</span><span class=s2>&#34;</span><span class=si>%s</span><span class=s2> </span><span class=si>%s</span><span class=s2> </span><span class=si>%s</span><span class=s2>&#34;</span> <span class=o>%</span><span class=p>(</span><span class=n>pass0</span><span class=p>,</span> <span class=n>pass1</span><span class=p>,</span> <span class=n>pass2</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=04_angr_symbolic_stack>04_angr_symbolic_stack</h3><p>Láº§n nÃ y input khÃ´ng lÆ°u trÃªn thanh ghi ná»¯a mÃ  Ä‘Æ°á»£c Ä‘á»ƒ trong stack. Váº­y thÃ¬ ta sáº½ Ä‘Æ°a symbol vÃ o stack thÃ´i!</p><p>Sau khi táº¡o state rá»“i simgr cÃ¡c kiá»ƒu thÃ¬ giá» ta báº¯t Ä‘áº§u xÃ©t Ä‘áº¿n stack. MÃ¬nh chá»n entry cho state lÃ  lá»‡nh â€œmov eax, [ebp+var_C]â€. VÃ¬ nháº£y vÃ o ngay giá»¯a cÃ¡i hÃ m nÃªn chÃºng ta chÆ°a cÃ³ stack frame (do 3 lá»‡nh â€œpush ebpâ€, â€œmov ebp, espâ€,â€sub esp, 18hâ€ Ä‘á»ƒ táº¡o stack frame náº±m á»Ÿ Ä‘áº§u hÃ m), ta pháº£i tá»± táº¡o thÃ´i</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>ebp</span> <span class=o>=</span> <span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>esp</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>esp</span> <span class=o>-=</span> <span class=mh>0x18</span>
</span></span></code></pre></td></tr></table></div></div><p>NhÃ¬n trong IDA thÃ¬ tháº¥y input Ä‘Æ°á»£c lÆ°u trong 2 Ã´ nhá»› lÃ  [ebp-0xc] vÃ  [ebp-0x10], váº­y giá» mÃ¬nh sáº½ Ä‘áº©y symbol vÃ o 2 Ã´ nÃ y.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>ebp</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>ebp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>first</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVS</span><span class=p>(</span><span class=s2>&#34;first&#34;</span><span class=p>,</span><span class=mi>32</span><span class=n>sstate</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVS</span><span class=p>(</span><span class=s2>&#34;second&#34;</span><span class=p>,</span><span class=mi>32</span><span class=n>state</span><span class=o>.</span><span class=n>mestate</span><span class=o>.</span><span class=n>memory</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=n>ebp</span><span class=o>-</span><span class=mh>0xc</span><span class=p>,</span><span class=n>first</span><span class=p>,</span><span class=n>endness</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>arch</span><span class=o>.</span><span class=n>memory_endness</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>memory</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=n>ebp</span><span class=o>-</span><span class=mh>0x10</span><span class=p>,</span><span class=n>second</span><span class=p>,</span><span class=n>endness</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>arch</span><span class=o>.</span><span class=n>memory_endness</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>**Note: ** Theo máº·c Ä‘á»‹nh thÃ¬ lá»‡nh memory.store sáº½ lÆ°u giÃ¡ trá»‹ theo kiá»ƒu â€œbig-endianâ€, do Ä‘Ã³ ta cáº§n pháº£i chá»‰nh láº¡i chá»— nÃ y cho Ä‘Ãºng báº±ng cÃ¡ch thÃªm tham sá»‘ endness (chá»— nÃ y mÃ¬nh ngá»“i cáº£ buá»•i má»›i phÃ¡t hiá»‡n ra ğŸ™‚ , rÃºt kinh nghiá»‡m láº§n sau pháº£i Ä‘á»c document cho ká»¹)</p><p>VÃ  pháº§n cÃ²n láº¡i chá»‰ lÃ  explore thÃ´i</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>good</span><span class=o>=</span><span class=mh>0x080486E9</span>
</span></span><span class=line><span class=cl><span class=n>bad</span><span class=o>=</span><span class=mh>0x080486D7</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>.</span><span class=n>explore</span><span class=p>(</span><span class=n>find</span><span class=o>=</span><span class=n>good</span><span class=p>,</span><span class=n>avoid</span><span class=o>=</span><span class=n>bad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=ow>not</span> <span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>):</span>
</span></span><span class=line><span class=cl>     <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&#34;Something is wrong!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>result</span><span class=o>=</span><span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>first</span><span class=o>=</span><span class=n>result</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>first</span><span class=p>,</span><span class=n>cast_to</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>second</span><span class=o>=</span><span class=n>result</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>second</span><span class=p>,</span><span class=n>cast_to</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=p>(</span><span class=s2>&#34;</span><span class=si>%d</span><span class=s2> </span><span class=si>%d</span><span class=s2>&#34;</span> <span class=o>%</span><span class=p>(</span><span class=n>first</span><span class=p>,</span> <span class=n>second</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Note:</strong> CÃ³ má»™t cÃ¡ch giáº£i khÃ¡c trong pháº§n solution, cÃ¡ch nÃ y dÃ¹ng lá»‡nh â€œstate.stack_pushâ€. DÃ¹ng lá»‡nh nÃ y thÃ¬ ta khÃ´ng cáº§n quan tÃ¢m endianess, Ä‘á»“ng thá»i cÃ¡ch xá»­ lÃ½ ebp vÃ  esp cÅ©ng hÆ¡i khÃ¡c má»™t chÃºt. (NhÃ¬n chung thÃ¬ khÃ´ng khÃ¡c nhiá»u, note láº¡i Ä‘á»ƒ nhá»› lá»‡nh stack_push thÃ´i ğŸ˜€ )</p><h3 id=05_angr_symbolic_memory>05_angr_symbolic_memory</h3><p>CÅ©ng nhÆ° bÃ i trÆ°á»›c, nhÆ°ng láº§n nÃ y dá»… hÆ¡n vÃ¬ input Ä‘Æ°á»£c lÆ°u vÃ o trong global variable, mÃ  cÃ¡c biáº¿n nÃ y thÃ¬ cÃ³ Ä‘á»‹a chá»‰ xÃ¡c Ä‘á»‹nh.</p><h3 id=06_angr_symbolic_dynamic_memory>06_angr_symbolic_dynamic_memory</h3><p>Láº§n nÃ y thÃ¬ binary sáº½ táº¡o 2 vÃ¹ng nhá»› Ä‘á»™ng rá»“i lÆ°u input trÃªn Ä‘Ã³, Ä‘iá»u nÃ y khiáº¿n cho cÃ¡ch cá»§a bÃ i 5 khÃ´ng lÃ m Ä‘Æ°á»£c vÃ¬ ta chá»‰ biáº¿t Ä‘Æ°á»£c Ä‘á»‹a chá»‰ cá»§a 2 vÃ¹ng nhá»› vÃ o runtime.</p><p>Tuy nhiÃªn nhÃ¬n vÃ o IDA thÃ¬ ta tháº¥y ráº±ng Ä‘á»‹a chá»‰ cá»§a 2 vÃ¹ng nhá»› Ä‘á»™ng sáº½ Ä‘Æ°á»£c lÆ°u trong 2 biáº¿n global Ä‘Ã£ biáº¿t Ä‘á»‹a chá»‰. Váº­y Ã½ tÆ°á»Ÿng giáº£i bÃ i nÃ y sáº½ lÃ  lÆ°u 2 Ä‘á»‹a chá»‰ do mÃ¬nh chá»n vÃ o cÃ¡c biáº¿n global: buffer0 vÃ  buffer1, tiáº¿p Ä‘Ã³ Ä‘Æ°a 2 symbol vÃ o 2 Ä‘á»‹a chá»‰ trÃªn.</p><p>Full script nhÆ° sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>angr</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>proj</span><span class=o>=</span><span class=n>angr</span><span class=o>.</span><span class=n>Project</span><span class=p>(</span><span class=s2>&#34;./06_angr_symbolic_dynamic_memory&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>entry</span><span class=o>=</span><span class=mh>0x08048687</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>blank_state</span><span class=p>(</span><span class=n>addr</span><span class=o>=</span><span class=n>entry</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>simulation_manager</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#initialize stack frame</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>ebp</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>esp</span> 
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>esp</span> <span class=o>-=</span><span class=mh>0x10</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#set the address of 2 buffer</span>
</span></span><span class=line><span class=cl><span class=n>buffer0</span><span class=o>=</span><span class=mh>0x10000000</span>
</span></span><span class=line><span class=cl><span class=n>buffer1</span><span class=o>=</span><span class=mh>0x20000000</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>memory</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=mh>0x0ABCC8A4</span><span class=p>,</span><span class=n>buffer0</span><span class=p>,</span><span class=n>endness</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>arch</span><span class=o>.</span><span class=n>memory_endness</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>memory</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=mh>0x0ABCC8AC</span><span class=p>,</span><span class=n>buffer1</span><span class=p>,</span><span class=n>endness</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>arch</span><span class=o>.</span><span class=n>memory_endness</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>sym0</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVS</span><span class=p>(</span><span class=s2>&#34;sym0&#34;</span><span class=p>,</span><span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sym1</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVS</span><span class=p>(</span><span class=s2>&#34;sym1&#34;</span><span class=p>,</span><span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#the symbols are strings so no need for endness argument</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>memory</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=n>buffer0</span><span class=p>,</span><span class=n>sym0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>memory</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=n>buffer1</span><span class=p>,</span><span class=n>sym1</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>good</span><span class=o>=</span><span class=mh>0x08048759</span>
</span></span><span class=line><span class=cl><span class=n>bad</span><span class=o>=</span><span class=mh>0x08048747</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>.</span><span class=n>explore</span><span class=p>(</span><span class=n>find</span><span class=o>=</span><span class=n>good</span><span class=p>,</span><span class=n>avoid</span><span class=o>=</span><span class=n>bad</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=ow>not</span> <span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&#34;Something is wrong&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>result</span><span class=o>=</span><span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>flag0</span><span class=o>=</span><span class=n>result</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>sym0</span><span class=p>,</span><span class=n>cast_to</span><span class=o>=</span><span class=nb>bytes</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>flag1</span><span class=o>=</span><span class=n>result</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>sym1</span><span class=p>,</span><span class=n>cast_to</span><span class=o>=</span><span class=nb>bytes</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=p>(</span><span class=s2>&#34;</span><span class=si>%s</span><span class=s2> </span><span class=si>%s</span><span class=s2>&#34;</span> <span class=o>%</span><span class=p>(</span><span class=n>flag0</span><span class=p>,</span><span class=n>flag1</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=08_angr_constraints>08_angr_constraints</h3><p>Binary láº¥y input, encode, sau Ä‘Ã³ cho vÃ o hÃ m Ä‘á»ƒ check.</p><p>VÃ o hÃ m Ä‘Ã³ xem thÃ¬ tháº¥y nÃ³ so sÃ¡nh tá»«ng char cá»§a input sau khi encode vá»›i tá»«ng chá»¯ trong string â€œAUPDNNPROEZRJWKBâ€. Váº­y lÃ  ta cÃ³ má»™t vÃ²ng láº·p 16 láº§n, náº¿u Ä‘á»ƒ angr thá»­ háº¿t táº¥t cáº£ cÃ¡c trÆ°á»ng há»£p thÃ¬ hÆ¡i lÃ¢u, vÃ¬ tháº¿ nÃªn bÃ i nÃ y ta sáº½ dá»«ng ngay trÆ°á»›c lá»‡nh call (tá»©c khÃ´ng gá»i hÃ m so sÃ¡nh), sau Ä‘Ã³ add constraint vÃ o báº±ng tay. (LÆ°u Ã½ lÃ  sau khi dá»«ng chÆ°Æ¡ng trÃ¬nh Ä‘á»ƒ thÃªm constraint thÃ¬ ta khÃ´ng cho cháº¡y tiáº¿p ná»¯a, do Ä‘Ã³ á»Ÿ Ä‘Ã¢y khÃ´ng cÃ³ Ä‘oáº¡n find vá»›i avoid)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>angr</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>proj</span><span class=o>=</span><span class=n>angr</span><span class=o>.</span><span class=n>Project</span><span class=p>(</span><span class=s2>&#34;./08_angr_constraints&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>entry</span><span class=o>=</span><span class=mh>0x08048625</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>blank_state</span><span class=p>(</span><span class=n>addr</span><span class=o>=</span><span class=n>entry</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>=</span><span class=n>proj</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>simulation_manager</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#add symbol to buffer </span>
</span></span><span class=line><span class=cl><span class=n>password</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVS</span><span class=p>(</span><span class=s2>&#34;password&#34;</span><span class=p>,</span><span class=mi>16</span><span class=o>*</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>buffer_addr</span><span class=o>=</span><span class=mh>0x0804A050</span>
</span></span><span class=line><span class=cl><span class=n>state</span><span class=o>.</span><span class=n>memory</span><span class=o>.</span><span class=n>store</span><span class=p>(</span><span class=n>buffer_addr</span><span class=p>,</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>#stop before the check function </span>
</span></span><span class=line><span class=cl><span class=n>check_addr</span><span class=o>=</span><span class=mh>0x08048673</span>
</span></span><span class=line><span class=cl><span class=n>simgr</span><span class=o>.</span><span class=n>explore</span><span class=p>(</span><span class=n>find</span><span class=o>=</span><span class=n>check_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=ow>not</span> <span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&#34;Wrong!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>result</span><span class=o>=</span><span class=n>simgr</span><span class=o>.</span><span class=n>found</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>complex_pass</span><span class=o>=</span><span class=n>result</span><span class=o>.</span><span class=n>memory</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>buffer_addr</span><span class=p>,</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>result</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>complex_pass</span><span class=o>==</span><span class=s2>&#34;AUPDNNPROEZRJWKB&#34;</span><span class=p>)</span> <span class=c1>#add 1 constraint</span>
</span></span><span class=line><span class=cl><span class=n>password</span><span class=o>=</span><span class=n>result</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>password</span><span class=p>,</span><span class=n>cast_to</span><span class=o>=</span><span class=nb>bytes</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=09_angr_hooks>09_angr_hooks</h3><p>BÃ i nÃ y cÅ©ng giá»‘ng nhÆ° bÃ i trÆ°á»›c, tuy nhiÃªn cÃ³ má»™t Ä‘iá»ƒm khÃ¡c khiáº¿n cho viá»‡c add constraint báº±ng tay trá»Ÿ nÃªn kÃ©m hiá»‡u quáº£ hÆ¡n</p><p>Sau hÃ m check string dÃ i dÃ i kia thÃ¬ chÆ°Æ¡ng trÃ¬nh cÃ²n 1 láº§n check ná»¯a. Náº¿u ta dá»«ng láº¡i trÆ°á»›c hÃ m â€œcheck_equalâ€¦â€ rá»“i thÃªm constraint báº±ng tay thÃ¬ sáº½ bá» máº¥t Ä‘oáº¡n sau. ChÃ­nh vÃ¬ tháº¿ ta sáº½ dÃ¹ng Ä‘áº¿n hook, má»™t cÃ´ng cá»¥ cá»§a Angr cho phÃ©p ta thay má»™t hay nhiá»u cÃ¢u lá»‡nh trong binary báº±ng má»™t hÃ m trong python do ngÆ°á»i dÃ¹ng viáº¿t.</p><p>Cáº¥u trÃºc lá»‡nh:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@proj</span><span class=o>.</span><span class=n>hook</span><span class=p>(</span><span class=o>&lt;</span><span class=n>addr</span><span class=o>&gt;</span><span class=p>,</span><span class=n>length</span><span class=o>=&lt;&gt;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>hooker</span><span class=p>(</span><span class=n>state</span><span class=p>):</span> <span class=c1>#hÃ m Ä‘Æ°á»£c thay</span>
</span></span></code></pre></td></tr></table></div></div><p>TÃ¡c dá»¥ng nhÆ° sau: khi chÆ°Æ¡ng trÃ¬nh thá»±c thi tá»›i lá»‡nh á»Ÿ Ä‘á»‹a chá»‰ , nÃ³ sáº½ dá»«ng láº¡i vÃ  cháº¡y hÃ m ( ğŸ™‚ ) cá»§a chÃºng ta, sau Ä‘Ã³ sáº½ bá» qua byte káº¿ tiáº¿p (lÆ°u Ã½ lÃ  bá» n byte chá»© khÃ´ng pháº£i bá» n lá»‡nh)</p><p>Vá»›i bÃ i nÃ y thÃ¬ mÃ¬nh muá»‘n chÆ°Æ¡ng trÃ¬nh khÃ´ng thá»±c hiá»‡n hÃ m check_equal mÃ  sáº½ cháº¡y hÃ m cá»§a mÃ¬nh. Do dÃ³ mÃ¬nh nháº­p tham sá»‘ addr lÃ  Ä‘á»‹a chá»‰ ngay chá»— gá»i hÃ m check_equal, length thÃ¬ cÃ³ thá»ƒ má»Ÿ ida lÃªn lÃ  tÃ­nh Ä‘Æ°á»£c. Váº­y giá» chá»‰ cáº§n quan tÃ¢m xem hÃ m hooker sáº½ lÃ m gÃ¬ thÃ´i.</p><p>NhÃ¬n vÃ o IDA má»™t láº§n ná»¯a, ta tháº¥y giÃ¡ trá»‹ tráº£ vá» cá»§a hÃ m check_equal Ä‘Æ°á»£c lÆ°u vÃ o eax. Ok, váº­y Ä‘Ã¢y sáº½ lÃ  hooker cá»§a mÃ¬nh</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@proj</span><span class=o>.</span><span class=n>hook</span><span class=p>(</span><span class=mh>0x080486A9</span><span class=p>,</span><span class=n>length</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hooker</span><span class=p>(</span><span class=n>state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>passwd_buffer</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>memory</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=mh>0x0804A054</span><span class=p>,</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>eax</span> <span class=o>=</span> <span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>If</span><span class=p>(</span><span class=n>passwd_buffer</span><span class=o>==</span><span class=s2>&#34;XYMKBKUHNIQYNQXE&#34;</span><span class=p>,</span><span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVV</span><span class=p>(</span><span class=mi>1</span><span class=n>statstate</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVV</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>32</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Note:</strong> ÄÃ¢y lÃ  má»™t sá»‘ Ä‘iá»u mÃ¬nh rÃºt ra sau khi viáº¿t hÃ m nÃ y:
â€“ Lá»‡nh state.solver.If(â€¦.) thá»ƒ hiá»‡n má»™t má»‡nh Ä‘á» if-then-else vÃ  nÃ³ khÃ´ng tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i viá»‡c viáº¿t</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>is_true</span><span class=p>(</span><span class=n>passwd_buffer</span><span class=o>==</span><span class=s2>&#34;XYMKBKUHNIQYNQXE&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>   <span class=n>state</span><span class=o>.</span><span class=n>regs</span><span class=o>.</span><span class=n>eax</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>solver</span><span class=o>.</span><span class=n>BVV</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>32</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>KhÃ´ng thá»ƒ thay tháº¿ <em><strong>state.solver.BVV(1,32)</strong></em> vÃ  <em><strong>state.solver.BVV(0,32)</strong></em> báº±ng 1 vÃ  0 Ä‘Æ°á»£c. LÃ½ do thÃ¬ mÃ¬nh chÆ°a biáº¿t ğŸ™‚ (cháº¯c pháº£i nghÃ­a qua claripy má»™t chÃºt)</li></ul><h3 id=12_angr_veritesting>12_angr_veritesting</h3><p>Veritesting lÃ  má»™t thuáº­t toÃ¡n dÃ¹ng Ä‘á»ƒ gá»™p cÃ¡c nhÃ¡nh ráº½ trong luá»“ng thá»±c thi, giÃºp cho symbolic execution Ä‘á»¡ tá»‘n thá»i gian hÆ¡n. Äá»ƒ enable veritesting thÃ¬ khi táº¡o simulation manager, ta chá»‰ cáº§n:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>simulation</span> <span class=o>=</span> <span class=n>project</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>simgr</span><span class=p>(</span><span class=n>initial_state</span><span class=p>,</span> <span class=n>veritesting</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>BÃ i nÃ y thá»±c ra y há»‡t nhÆ° bÃ i trÃªn. Tuy nhiÃªn nhá» veritesting gá»™p nhÃ¡nh vÃ  lÃ m Ä‘Æ¡n giáº£n hÃ m nÃªn ta khÃ´ng pháº£i code hÃ m Ä‘á»ƒ hook ná»¯a.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2020-07-07</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=../../../tags/learning/>learning</a>,&nbsp;<a href=../../../tags/writeup/>writeup</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=../../../>Home</a></span></section></div><div class=post-nav><a href=../../../posts/old_posts/2020-7-7-aslr/ class=prev rel=prev title="Heap and Address Space Layout Randomization"><i class="fas fa-angle-left fa-fw"></i>Heap and Address Space Layout Randomization</a>
<a href=../../../posts/old_posts/2020-07-07-angr-basic/ class=next rel=next title="Angr basic">Angr basic<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.99.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=../../../ target=_blank>Frost</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=../../../lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=../../../lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=../../../lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:100},comment:{}}</script><script type=text/javascript src=../../../js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CY316V8Z0V")</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-CY316V8Z0V" async></script></body></html>